# Результаты выполнения заданий по SQL (День 07)

В этом проекте представлены решения 9 упражнений по SQL, направленных на работу с агрегированными данными и аналитические запросы. Каждое упражнение выполнено в отдельном SQL-файле.

## Список выполненных заданий:

### Упражнение 00
**Файл:** `day07_ex00.sql`  
**Задача:** Получить идентификаторы persons и количество их посещений пиццерий.  
**Решение:** Группировка по person_id с подсчетом количества посещений и соответствующей сортировкой.

### Упражнение 01
**Файл:** `day07_ex01.sql`  
**Задача:** Показать имена 4 людей с наибольшим количеством посещений.  
**Решение:** JOIN с таблицей person для получения имен и ограничение вывода до 4 записей.

### Упражнение 02
**Файл:** `day07_ex02.sql`  
**Задача:** Получить топ-3 пиццерии по заказам и посещениям с указанием типа действия.  
**Решение:** UNION двух запросов с разными условиями агрегации и сортировкой.

### Упражнение 03
**Файл:** `day07_ex03.sql`  
**Задача:** Объединить статистику заказов и посещений по пиццериям.  
**Решение:** Использование CTE и FULL JOIN для объединения данных с обработкой NULL значений.

### Упражнение 04
**Файл:** `day07_ex04.sql`  
**Задача:** Найти людей с более чем 3 посещениями.  
**Решение:** Фильтрация с помощью HAVING после группировки.

### Упражнение 05
**Файл:** `day07_ex05.sql`  
**Задача:** Получить уникальные имена людей, сделавших заказы.  
**Решение:** Использование DISTINCT для получения уникальных значений.

### Упражнение 06
**Файл:** `day07_ex06.sql`  
**Задача:** Получить метрики по заказам для каждой пиццерии.  
**Решение:** Агрегатные функции (COUNT, AVG, MAX, MIN) с группировкой и округлением.

### Упражнение 07
**Файл:** `day07_ex07.sql`  
**Задача:** Вычислить средний глобальный рейтинг пиццерий.  
**Решение:** Использование AVG с округлением до 4 знаков.

### Упражнение 08
**Файл:** `day07_ex08.sql`  
**Задача:** Найти количество заказов по адресам и пиццериям.  
**Решение:** Многотабличный JOIN с группировкой по адресу и названию пиццерии.

### Упражнение 09
**Файл:** `day07_ex09.sql`  
**Задача:** Выполнить сложные вычисления с возрастами по адресам.  
**Решение:** Использование CTE для вычисления формул и сравнения результатов.

## Используемые технологии:
- PostgreSQL
- ANSI SQL
- Агрегатные функции: COUNT, AVG, MAX, MIN
- Группировка данных: GROUP BY
- Фильтрация групп: HAVING
- Объединение результатов: UNION
- Округление чисел: ROUND
- Работа с NULL: COALESCE
- Условные выражения: CASE
- Общие табличные выражения (CTE)
- Сложные JOIN операции
- Сортировка результатов: ORDER BY

Все решения проверены на соответствие требованиям заданий и используют только разрешенные конструкции SQL. Запросы оптимизированы для лучшей производительности и читаемости. В решениях учтены все аспекты работы с агрегированными данными и аналитическими функциями.