# Результаты выполнения группового проекта "Data Warehouse"

## Авторы проекта:
- Aglet Craitbla ([GitHub](https://github.com/Craitbla))
- Anna BalagurovaA ([GitHub](https://github.com/BalagurovaA))
- Амир Габитов ([GitHub](https://github.com/keyluxy))

## Описание проекта
В этом проекте представлены решения задач по созданию и работе с Data Warehouse (DWH) на PostgreSQL. Проект включает два упражнения, направленных на обработку данных из различных источников с учетом временных меток и аномалий данных.

## Список выполненных заданий:

### Упражнение 00
**Файл:** `team00_ex00.sql`  
**Задача:** Рассчитать общий объем транзакций по пользователям и типам баланса с конвертацией в USD.  
**Решение:** 
- Агрегация данных о балансах по пользователям и типам
- Определение последнего курса валюты для конвертации
- Обработка NULL-значений в данных
- Конвертация в USD с использованием последнего известного курса

### Упражнение 01
**Файл:** `team01_ex01.sql`  
**Задача:** Найти ближайший курс валюты для каждой транзакции и рассчитать сумму в USD.  
**Скрипт:** [база данных](/materials/rush01_model.sql) \
**Решение:** 
- Создание функции для поиска ближайшего курса валюты
- Обработка случаев, когда курс в прошлом не найден (поиск в будущем)
- Соединение данных о пользователях, балансах и валютах
- Расчет суммы в USD с учетом временных меток

## Используемые технологии:
- PostgreSQL
- SQL запросы с агрегацией данных
- Оконные функции (ROW_NUMBER) для определения последних значений
- Пользовательские функции (CREATE FUNCTION)
- Полные соединения (FULL JOIN) для обработки всех данных
- Обработка NULL-значений (COALESCE)
- Временные метки и работа с датами

## Ключевые особенности решений:
1. **Обработка аномалий данных**: Учет случаев отсутствия пользователей, курсов валют и других NULL-значений
2. **Временная логика**: Корректная обработка временных меток для нахождения актуальных курсов валют
3. **Гибкость решений**: Возможность работы с различными сценариями данных
4. **Производительность**: Использование эффективных SQL-конструкций для обработки больших объемов данных

Все решения проверены на корректность работы и соответствие требованиям задач. Запросы оптимизированы для лучшей производительности и читаемости.